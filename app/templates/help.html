{% extends "base.html" %}

{% block title %}ヘルプ・マニュアル | 野球部タレントマネジメントシステム{% endblock %}

{% block content %}
<div class="container fade-in">
    <h1>📖 ヘルプセンター</h1>
    <p class="help-subtitle">野球部タレントマネジメントシステムの使用方法とよくある質問</p>

    <!-- システム概要 -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">⚾ システム概要</h3>
        </div>
        <div class="d-grid gap-4">
            <p>野球部タレントマネジメントシステムは、部員の能力測定データを管理・分析し、チーム全体の成長を支援するためのシステムです。</p>
            
            <div class="security-notice">
                <div class="security-icon">🔒</div>
                <div class="security-content">
                    <h4>セキュリティに関する重要なお知らせ</h4>
                    <p><strong>初期パスワードは「password123」に設定されています。</strong>セキュリティのため、初回ログイン後は必ず「プロフィール」という項目にアクセスしてパスワードを変更してください。</p>
                </div>
            </div>
            
            <div class="feature-grid">
                <div class="feature-item">
                    <div class="feature-icon">📊</div>
                    <h4>測定記録管理</h4>
                    <p>初期値で8つの測定項目を電子化して管理。</p>
                    <p>測定項目は、管理者が自由に追加・編集・削除できます。</p>
                </div>
                
                <div class="feature-item">
                    <div class="feature-icon">📈</div>
                    <h4>成長分析</h4>
                    <p>個人の成長を時系列で確認し、部内での順位や偏差値を表示。</p>
                </div>
                
                <div class="feature-item">
                    <div class="feature-icon">👥</div>
                    <h4>チーム分析</h4>
                    <p>チーム全体の傾向を分析しレーダチャートを表示。戦略策定に役立つデータを提供</p>
                </div>
                
                <div class="feature-item">
                    <div class="feature-icon">🔔</div>
                    <h4>通知システム</h4>
                    <p>承認待ちの記録をリアルタイムで通知。</p>
                </div>
            </div>

            <!-- 学年更新システム -->
            <div class="grade-update-notice">
                <div class="grade-update-icon">🎓</div>
                <div class="grade-update-content">
                    <h4>学年更新システム</h4>
                    <p><strong>毎年4月1日に自動的に学年更新が行われます。</strong></p>
                    <ul>
                        <li>部員とマネージャーの学年が1つずつ上がります</li>
                        <li>3年生以上の部員・マネージャーは自動的にシステムから削除されます</li>
                    </ul>
                    <p class="grade-update-note">※ 学年更新により削除されたデータは復元できません。重要なデータは事前にバックアップを取ってください。</p>
                </div>
            </div>
        </div>
    </div>

    <!-- 承認フロー詳細ガイド -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">✅ 承認フロー詳細ガイド</h3>
        </div>
        <div class="approval-guide">
            <div class="approval-overview" style="margin-bottom:2rem;">
                <h4>📋 測定記録登録の流れ</h4>
                
                <!-- 承認フローチャート -->
                <div class="approval-flowchart">
                    <!-- Step 1: マネージャー入力 -->
                    <div class="flow-step manager-step">
                        <div class="step-header">
                            <div class="step-icon">📝</div>
                            <div class="step-title">Step 1</div>
                        </div>
                        <div class="step-content">
                            <h5>マネージャーが測定記録を作成・提出</h5>
                            <div class="step-details">
                                <p>• 個別記録入力またはCSV一括入力</p>
                                <p>• 測定日、部員、各項目の数値を入力</p>
                                <p>• 記録を提出すると部員に通知</p>
                            </div>
                        </div>
                    </div>

                    <!-- Arrow 1 -->
                    <div class="flow-arrow">
                        <div class="arrow-line"></div>
                        <div class="arrow-head"></div>
                    </div>

                    <!-- Step 2: 部員確認 -->
                    <div class="flow-step member-step">
                        <div class="step-header">
                            <div class="step-icon">👤</div>
                            <div class="step-title">Step 2</div>
                        </div>
                        <div class="step-content">
                            <h5>部員が測定記録を確認・承認</h5>
                            <div class="step-details">
                                <p>• 自分の記録が正しいか確認</p>
                                <p>• 承認または差し戻しを選択</p>
                                <p>• 差し戻し時はコメントを記入</p>
                            </div>
                        </div>
                    </div>

                    <!-- Arrow 2 -->
                    <div class="flow-arrow">
                        <div class="arrow-line"></div>
                        <div class="arrow-head"></div>
                    </div>

                    <!-- Step 3: コーチ承認 -->
                    <div class="flow-step coach-step">
                        <div class="step-header">
                            <div class="step-icon">🏆</div>
                            <div class="step-title">Step 3</div>
                        </div>
                        <div class="step-content">
                            <h5>コーチが最終確認・承認</h5>
                            <div class="step-details">
                                <p>• 部員承認済み記録を最終確認</p>
                                <p>• 承認または差し戻しを選択</p>
                                <p>• 差し戻し時はコメントを記入</p>
                            </div>
                        </div>
                    </div>

                    <!-- Arrow 3 -->
                    <div class="flow-arrow">
                        <div class="arrow-line"></div>
                        <div class="arrow-head"></div>
                    </div>

                    <!-- Step 4: 完了 -->
                    <div class="flow-step complete-step">
                        <div class="step-header">
                            <div class="step-icon">✅</div>
                            <div class="step-title">Step 4</div>
                        </div>
                        <div class="step-content">
                            <h5>記録が正式登録</h5>
                            <div class="step-details">
                                <p>• 正式な測定記録として保存</p>
                                <p>• 成長分析に反映</p>
                                <p>• チーム分析に反映</p>
                            </div>
                        </div>
                        <div class="step-status completed">完了</div>
                    </div>
                </div>

                <!-- 差し戻しフロー -->
                <div class="rejection-flow">
                    <h5>🔄 差し戻しフロー</h5>
                    <div class="rejection-steps">
                        <div class="rejection-step">
                            <div class="rejection-icon">❌</div>
                            <div class="rejection-content">
                                <h6>差し戻し発生</h6>
                                <p>部員またはコーチが記録を差し戻し</p>
                            </div>
                        </div>
                        <div class="rejection-arrow">→</div>
                        <div class="rejection-step">
                            <div class="rejection-icon">📧</div>
                            <div class="rejection-content">
                                <h6>通知送信</h6>
                                <p>マネージャーに差し戻し通知</p>
                            </div>
                        </div>
                        <div class="rejection-arrow">→</div>
                        <div class="rejection-step">
                            <div class="rejection-icon">📝</div>
                            <div class="rejection-content">
                                <h6>修正・再提出</h6>
                                <p>マネージャーが修正して再提出</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 重要な注意事項 -->
                <div class="approval-notes">
                    <h5>📌 重要な注意事項</h5>
                    <div class="notes-grid">
                        <div class="note-item">
                            <div class="note-icon">⏰</div>
                            <div class="note-content">
                                <h6>承認期限</h6>
                                <p>記録は承認されるまで正式記録として扱われません</p>
                            </div>
                        </div>
                        <div class="note-item">
                            <div class="note-icon">🔍</div>
                            <div class="note-content">
                                <h6>確認の重要性</h6>
                                <p>各ステップで慎重に確認を行い、正確な記録を維持</p>
                            </div>
                        </div>
                        <div class="note-item">
                            <div class="note-icon">📱</div>
                            <div class="note-content">
                                <h6>通知システム</h6>
                                <p>承認待ちや差し戻しはリアルタイムで通知</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 役割別ガイド -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">👤 役割別ガイド</h3>
        </div>
        
        <!-- 管理者向け -->
        <div class="role-section">
            <h4 class="role-title">⚙️ 管理者向け</h4>
            <div class="role-content">
                <div class="role-feature">
                    <h5>🔧 システム管理</h5>
                    <ul>
                        <li>データベースの初期化</li>
                        <li>測定項目の追加、削除</li>
                        <li>連絡先の登録</li>
                    </ul>
                </div>
                <div class="role-feature">
                    <h5>📊 測定記録入力</h5>
                    <ul>
                        <li>CSVにより、初めから承認された記録の入力が可能（十分に確認したのちに行うこと）</li>
                    </ul>
                </div>
                <div class="role-feature">
                    <h5>📈 その他の機能</h5>
                    <ul>
                        <li>監督・コーチと同等の機能を利用可能</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- コーチ・監督向け -->
        <div class="role-section">
            <h4 class="role-title">🏆 コーチ・監督向け</h4>
            <div class="role-content">
                <div class="role-feature">
                    <h5>👥 部員管理</h5>
                    <ul>
                        <li>部員一覧の確認</li>
                        <li>部員の登録・削除</li>
                        <li>部員情報の編集</li>
                    </ul>
                </div>
                <div class="role-feature">
                    <h5>📈 チーム分析</h5>
                    <ul>
                        <li>チーム全体の成績レベルをレーダーチャートで確認</li>
                        <li>個人成績の確認</li>
                    </ul>
                </div>
                <div class="role-feature">
                    <h5>✅ 承認管理（コーチのみ）</h5>
                    <ul>
                        <li>測定記録の最終承認</li>
                        <li>承認待ち記録の確認</li>
                        <li>差し戻し処理</li>
                    </ul>
                </div>
                <div class="role-feature">
                    <h5>📢 お知らせ管理</h5>
                    <ul>
                        <li>お知らせの追加</li>
                        <li>お知らせの削除</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- マネージャー向け -->
        <div class="role-section">
            <h4 class="role-title">📝 マネージャー向け</h4>
            <div class="role-content">
                <div class="role-feature">
                    <h5>📊 測定記録入力</h5>
                    <ul>
                        <li>個別記録の入力</li>
                        <li>CSVファイルによる一括入力</li>
                    </ul>
                </div>
                <div class="role-feature">
                    <h5>📋 記録管理</h5>
                    <ul>
                        <li>差し戻された記録の確認</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- 部員向け -->
        <div class="role-section">
            <h4 class="role-title">🏃 部員向け</h4>
            <div class="role-content">
                <div class="role-feature">
                    <h5>📈 個人記録確認</h5>
                    <ul>
                        <li>自分の測定記録を時系列で確認</li>
                        <li>部内での順位と偏差値を確認</li>
                        <li>成長の推移をグラフで表示</li>
                    </ul>
                </div>
                <div class="role-feature">
                    <h5>✅ 記録の確認</h5>
                    <ul>
                        <li>マネージャーが入力した記録が正しいか確認。</li>
                        <li>内容を承認すると、コーチに最終承認の通知が送られる。</li>
                        <li>間違いがある場合は、コメントを付けて差し戻すことができる。</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- よくある質問 -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">❓ よくある質問</h3>
        </div>
        <div class="faq-list">
            <div class="faq-item">
                <div class="faq-question">
                    <span class="faq-icon">🔑</span>
                    <h5>ログインできません。</h5>
                </div>
                <div class="faq-answer">
                    <p>ユーザー名とパスワードを確認してください。問題が続く場合はシステム管理者に連絡してください。</p>
                </div>
            </div>

            <div class="faq-item">
                <div class="faq-question">
                    <span class="faq-icon">🔐</span>
                    <h5>パスワードを変更したい</h5>
                </div>
                <div class="faq-answer">
                    <p>プロフィールからパスワードを変更できます。</p>
                    <p><strong>重要:</strong> 初期パスワードは「password123」に設定されています。セキュリティのため、初回ログイン後は必ず「プロフィール」という項目にアクセスしてパスワードを変更してください。</p>
                </div>
            </div>

            <div class="faq-item">
                <div class="faq-question">
                    <span class="faq-icon">📊</span>
                    <h5>測定記録の入力方法を教えてください</h5>
                </div>
                <div class="faq-answer">
                    <p>マネージャー、管理者のみが行えます。「測定記録入力」メニューから部員を選択し、各項目の数値を入力してください。CSVファイルでの一括入力も可能です。</p>
                </div>
            </div>

            <div class="faq-item">
                <div class="faq-question">
                    <span class="faq-icon">📱</span>
                    <h5>スマートフォンでも使えますか？</h5>
                </div>
                <div class="faq-answer">
                    <p>はい、レスポンシブデザインに対応しているため、スマートフォンやタブレットでも快適に使用できます。Chrome、Safari、Firefox等の主要ブラウザを推奨します。</p>
                </div>
            </div>

            <div class="faq-item">
                <div class="faq-question">
                    <span class="faq-icon">📈</span>
                    <h5>自分の記録を確認したい</h5>
                </div>
                <div class="faq-answer">
                    <p>部員としてログイン後、「記録閲覧」メニューから自分の測定記録を時系列で確認できます。部内での順位や偏差値も表示されます。</p>
                </div>
            </div>
        </div>
    </div>

    <!-- システム情報 -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">ℹ️ システム情報</h3>
        </div>
        <div class="system-info">
            <div class="info-row">
                <span class="info-label">システム名:</span>
                <span class="info-value">野球部タレントマネジメントシステム</span>
            </div>
            <div class="info-row">
                <span class="info-label">バージョン:</span>
                <span class="info-value">v1.0.0</span>
            </div>
            <div class="info-row">
                <span class="info-label">対応ブラウザ:</span>
                <span class="info-value">Chrome, Firefox, Safari, Edge (最新版)</span>
            </div>
            <div class="info-row">
                <span class="info-label">対応デバイス:</span>
                <span class="info-value">PC, スマートフォン, タブレット</span>
            </div>
        </div>
    </div>

    <!-- お問い合わせ -->
    <div class="card contact-card">
        <div class="card-header">
            <h3 class="card-title">📞 お問い合わせ</h3>
        </div>
        <div class="card-body">
            <p class="mb-3">システムに関する質問や不具合の報告は、以下の連絡先までお気軽にご連絡ください。</p>
            {% if contact %}
            <div class="row g-3">
                {% if contact.email %}
                <div class="col-md-4 col-12">
                    <div class="contact-box">
                        <div class="contact-icon">📧</div>
                        <div>
                            <div class="contact-label">メール</div>
                            <a href="mailto:{{ contact.email }}">{{ contact.email }}</a>
                        </div>
                    </div>
                </div>
                {% endif %}
                {% if contact.phone %}
                <div class="col-md-4 col-12">
                    <div class="contact-box">
                        <div class="contact-icon">📞</div>
                        <div>
                            <div class="contact-label">電話</div>
                            <span>{{ contact.phone }}</span>
                        </div>
                    </div>
                </div>
                {% endif %}
                {% if contact.note %}
                <div class="col-md-4 col-12">
                    <div class="contact-box">
                        <div class="contact-icon">📝</div>
                        <div>
                            <div class="contact-label">備考</div>
                            <span>{{ contact.note | nl2br }}</span>
                        </div>
                    </div>
                </div>
                {% endif %}
            </div>
            {% else %}
            <div class="alert alert-warning mt-3">
                現在、連絡先情報は登録されていません。
            </div>
            {% endif %}
        </div>
    </div>

</div>

<style>
/* ヘルプページ専用スタイル */
.help-subtitle {
    color: var(--gray-600);
    font-size: 1.125rem;
    margin-bottom: 2rem;
    text-align: center;
}

.security-notice {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
    padding: 1.5rem;
    background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
    border: 2px solid var(--warning);
    border-radius: var(--radius);
    margin-bottom: 1.5rem;
    box-shadow: var(--shadow);
}

.security-icon {
    font-size: 2rem;
    flex-shrink: 0;
}

.security-content h4 {
    color: var(--warning);
    margin-bottom: 0.5rem;
    font-weight: 600;
}

.security-content p {
    color: var(--gray-700);
    margin: 0;
    line-height: 1.6;
}

.feature-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
    margin-top: 1.5rem;
}

.feature-item {
    text-align: center;
    padding: 1.5rem;
    background: var(--gray-50);
    border-radius: var(--radius);
    border: 1px solid var(--gray-200);
    transition: var(--transition);
}

.feature-item:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow);
}

.feature-icon {
    font-size: 2.5rem;
    margin-bottom: 1rem;
    display: block;
}

.feature-item h4 {
    color: var(--primary-color);
    margin-bottom: 0.75rem;
    font-weight: 600;
}

.feature-item p {
    color: var(--gray-600);
    font-size: 0.875rem;
    line-height: 1.5;
}

.role-section {
    margin-bottom: 2rem;
    padding-bottom: 2rem;
    border-bottom: 1px solid var(--gray-200);
}

.role-section:last-child {
    border-bottom: none;
    margin-bottom: 0;
    padding-bottom: 0;
}

.role-title {
    color: var(--primary-color);
    font-size: 1.25rem;
    font-weight: 600;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.role-content {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
}

.role-feature h5 {
    color: var(--gray-800);
    font-weight: 600;
    margin-bottom: 0.75rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.role-feature ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

.role-feature li {
    padding: 0.5rem 0;
    color: var(--gray-600);
    position: relative;
    padding-left: 1.5rem;
}

.role-feature li::before {
    content: '✓';
    position: absolute;
    left: 0;
    color: var(--success);
    font-weight: bold;
}

.measurement-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
}

.measurement-item {
    padding: 1rem;
    background: var(--gray-50);
    border-radius: var(--radius);
    border: 1px solid var(--gray-200);
    text-align: center;
    transition: var(--transition);
}

.measurement-item:hover {
    background: var(--primary-color);
    color: var(--white);
    transform: translateY(-2px);
}

.measurement-item h5 {
    margin-bottom: 0.5rem;
    font-weight: 600;
}

.measurement-item p {
    font-size: 0.875rem;
    margin: 0;
}

.faq-list {
    display: grid;
    gap: 1rem;
}

.faq-item {
    border: 1px solid var(--gray-200);
    border-radius: var(--radius);
    overflow: hidden;
    transition: var(--transition);
}

.faq-item:hover {
    box-shadow: var(--shadow);
}

.faq-question {
    background: var(--gray-50);
    padding: 1rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    transition: var(--transition);
}

.faq-question:hover {
    background: var(--gray-100);
}

.faq-icon {
    font-size: 1.25rem;
}

.faq-question h5 {
    margin: 0;
    color: var(--gray-800);
    font-weight: 600;
}

.faq-answer {
    padding: 1rem;
    background: var(--white);
}

.faq-answer p {
    margin: 0;
    color: var(--gray-600);
    line-height: 1.6;
}

.system-info {
    display: grid;
    gap: 0.75rem;
}

.info-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem 0;
    border-bottom: 1px solid var(--gray-100);
}

.info-row:last-child {
    border-bottom: none;
}

.info-label {
    font-weight: 600;
    color: var(--gray-700);
}

.info-value {
    color: var(--gray-800);
    font-weight: 500;
}

.contact-card .card-body {
    background: #f9fafb;
    border-radius: 0 0 0.5rem 0.5rem;
}
.contact-box {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
    background: #fff;
    border: 1px solid #e5e7eb;
    border-radius: 0.5rem;
    padding: 1rem;
    box-shadow: 0 1px 4px rgba(0,0,0,0.03);
    margin-bottom: 0.5rem;
    min-height: 70px;
}
.contact-icon {
    font-size: 2rem;
    flex-shrink: 0;
    color: #2563eb;
}
.contact-label {
    font-weight: 600;
    color: #2563eb;
    margin-bottom: 0.25rem;
}
@media (max-width: 768px) {
    .contact-box {
        flex-direction: row;
        align-items: flex-start;
    }
}

.grade-update-notice {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
    padding: 1.5rem;
    background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
    border: 2px solid #3b82f6;
    border-radius: var(--radius);
    margin-top: 1.5rem;
    box-shadow: var(--shadow);
}

.grade-update-icon {
    font-size: 2rem;
    flex-shrink: 0;
}

.grade-update-content h4 {
    color: #1d4ed8;
    margin-bottom: 0.75rem;
    font-weight: 600;
}

.grade-update-content p {
    color: var(--gray-700);
    margin-bottom: 0.75rem;
    line-height: 1.6;
}

.grade-update-content ul {
    margin: 0.75rem 0;
    padding-left: 1.5rem;
    color: var(--gray-700);
}

.grade-update-content li {
    margin-bottom: 0.25rem;
    line-height: 1.5;
}

.grade-update-note {
    font-size: 0.875rem;
    color: #dc2626 !important;
    font-weight: 500;
    margin-top: 0.75rem !important;
    padding: 0.5rem;
    background: #fef2f2;
    border-radius: 0.25rem;
    border-left: 3px solid #dc2626;
}

.notification-system {
    margin-top: 1.5rem;
    padding: 1.5rem;
    background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
    border: 2px solid #3b82f6;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
}

.notification-explanation {
    margin-top: 1.5rem;
}

.notification-types {
    margin-bottom: 1.5rem;
}

.notification-grid {
    display: grid;
    gap: 1rem;
}

.notification-item {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
}

.notification-icon {
    font-size: 2rem;
    flex-shrink: 0;
}

.notification-content {
    flex: 1;
}

.notification-content h6 {
    color: var(--gray-800);
    font-weight: 600;
    margin-bottom: 0.5rem;
}

.notification-content p {
    color: var(--gray-600);
    margin: 0;
}

.notification-usage {
    margin-top: 1.5rem;
}

.notification-usage ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

.notification-usage li {
    padding: 0.5rem 0;
    color: var(--gray-600);
    position: relative;
    padding-left: 1.5rem;
}

.notification-usage li::before {
    content: '✓';
    position: absolute;
    left: 0;
    color: var(--success);
    font-weight: bold;
}

/* 承認フロー詳細ガイド用スタイル */
.approval-flowchart {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    margin: 2rem 0;
}

.flow-step {
    display: flex;
    align-items: stretch;
    background: var(--white);
    border: 2px solid var(--gray-200);
    border-radius: var(--radius);
    overflow: hidden;
    box-shadow: var(--shadow);
    transition: var(--transition);
    position: relative;
}

.flow-step:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.15);
}

.manager-step {
    border-left: 4px solid #3b82f6;
}

.member-step {
    border-left: 4px solid #10b981;
}

.coach-step {
    border-left: 4px solid #f59e0b;
}

.complete-step {
    border-left: 4px solid #8b5cf6;
}

.step-header {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background: var(--gray-50);
    padding: 1.5rem 1rem;
    min-width: 120px;
    border-right: 1px solid var(--gray-200);
}

.step-icon {
    font-size: 2.5rem;
    margin-bottom: 0.5rem;
}

.step-title {
    font-weight: 600;
    color: var(--gray-700);
    font-size: 0.875rem;
}

.step-content {
    flex: 1;
    padding: 1.5rem;
}

.step-content h5 {
    color: var(--gray-800);
    font-weight: 600;
    margin-bottom: 1rem;
    font-size: 1.125rem;
}

.step-details {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.step-details p {
    color: var(--gray-600);
    margin: 0;
    font-size: 0.875rem;
    line-height: 1.5;
}

.step-status {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 1rem;
    min-width: 100px;
    font-weight: 600;
    font-size: 0.875rem;
}

.step-status.pending {
    background: #fef3c7;
    color: #d97706;
}

.step-status.completed {
    background: #d1fae5;
    color: #059669;
}

.flow-arrow {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 40px;
    position: relative;
}

.arrow-line {
    width: 2px;
    height: 30px;
    background: var(--gray-300);
}

.arrow-head {
    position: absolute;
    bottom: 0;
    width: 0;
    height: 0;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-top: 8px solid var(--gray-300);
}

/* 差し戻しフロー */
.rejection-flow {
    margin-top: 2rem;
    padding: 1.5rem;
    background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
    border: 2px solid #fecaca;
    border-radius: var(--radius);
}

.rejection-flow h5 {
    color: #dc2626;
    font-weight: 600;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.rejection-steps {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    flex-wrap: wrap;
}

.rejection-step {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    background: var(--white);
    padding: 1rem;
    border-radius: var(--radius);
    border: 1px solid #fecaca;
    min-width: 150px;
}

.rejection-icon {
    font-size: 1.5rem;
    flex-shrink: 0;
}

.rejection-content h6 {
    color: var(--gray-800);
    font-weight: 600;
    margin: 0 0 0.25rem 0;
    font-size: 0.875rem;
}

.rejection-content p {
    color: var(--gray-600);
    margin: 0;
    font-size: 0.75rem;
    line-height: 1.4;
}

.rejection-arrow {
    color: #dc2626;
    font-weight: bold;
    font-size: 1.25rem;
}

/* 重要な注意事項 */
.approval-notes {
    margin-top: 2rem;
    padding: 1.5rem;
    background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
    border: 2px solid #bae6fd;
    border-radius: var(--radius);
}

.approval-notes h5 {
    color: #0369a1;
    font-weight: 600;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.notes-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1rem;
}

.note-item {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
    background: var(--white);
    padding: 1rem;
    border-radius: var(--radius);
    border: 1px solid #bae6fd;
}

.note-icon {
    font-size: 1.5rem;
    flex-shrink: 0;
}

.note-content h6 {
    color: var(--gray-800);
    font-weight: 600;
    margin: 0 0 0.25rem 0;
    font-size: 0.875rem;
}

.note-content p {
    color: var(--gray-600);
    margin: 0;
    font-size: 0.75rem;
    line-height: 1.4;
}

/* レスポンシブ対応 */
@media (max-width: 768px) {
    .flow-step {
        flex-direction: column;
    }
    
    .step-header {
        flex-direction: row;
        justify-content: center;
        gap: 0.75rem;
        padding: 1rem;
        border-right: none;
        border-bottom: 1px solid var(--gray-200);
    }
    
    .step-status {
        min-width: auto;
        padding: 0.75rem;
    }
    
    .rejection-steps {
        flex-direction: column;
        gap: 0.5rem;
    }
    
    .rejection-arrow {
        transform: rotate(90deg);
    }
    
    .notes-grid {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %}