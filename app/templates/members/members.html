{% extends "base.html" %}

{% block title %}éƒ¨å“¡ä¸€è¦§ | é‡çƒéƒ¨ã‚¿ãƒ¬ãƒ³ãƒˆãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ {% endblock %}

{% block content %}
<div class="container fade-in">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>ğŸ‘¥ éƒ¨å“¡ä¸€è¦§</h1>
        <div class="d-flex gap-2">
            <a href="{{ url_for('members.new_member') }}" class="btn btn-primary">
                <span class="icon">â•</span> æ–°è¦ç™»éŒ²
            </a>
            <a href="{{ url_for('members.csv_import') }}" class="btn btn-secondary">
                <span class="icon">ğŸ“„</span> CSVã§ä¸€æ‹¬ç™»éŒ²
            </a>
            <a href="{{ url_for('members.export_csv') }}" class="btn btn-info">
                <span class="icon">ğŸ“¤</span> CSVå‡ºåŠ›
            </a>
        </div>
    </div>

    <div class="card p-4">
        <div class="table-container">
            <table id="memberTable" class="table table-hover" style="width:100%">
                <thead>
                    <tr>
                        <th>æ°å</th>
                        <th>å­¦å¹´</th>
                        <th>å½¹å‰²</th>
                        <th>æ´»å‹•çŠ¶æ³</th>
                    </tr>
                </thead>
                <tbody>
                    {% for member in members %}
                    <tr>
                        <td><a href="{{ url_for('records.records', member_id=member.user_id) }}">{{ member.name }}</a></td>
                        <td>{{ member.grade or '-' }}</td>
                        <td>
                            {% for role in member.roles %}
                                <span class="badge badge-primary">{{ role.display_name or role.name }}</span>
                            {% endfor %}
                        </td>
                        <td>
                            {% if member.is_active %}
                                <span class="badge badge-success">ç¾å½¹</span>
                            {% else %}
                                <span class="badge badge-secondary">å¼•é€€</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/2.0.8/css/dataTables.dataTables.min.css">
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/2.0.8/js/dataTables.min.js"></script>

<script>
$(document).ready(function() {
    $('#memberTable').DataTable({
        "pageLength": 10,
        "language": {
            "url": "https://cdn.datatables.net/plug-ins/1.10.25/i18n/Japanese.json"
        },
        "columnDefs": [
            { "orderable": true, "targets": 0 }, // æ°å
            { "orderable": true, "targets": 1 }, // å­¦å¹´
            { "orderable": true, "targets": 2 }, // å½¹å‰²
            { "orderable": true, "targets": 3 }  // æ´»å‹•çŠ¶æ³
        ],
        "responsive": true
    });
});
</script>
<style>
.badge {
    display: inline-block;
    padding: 0.35em 0.65em;
    font-size: .75em;
    font-weight: 700;
    line-height: 1;
    color: #fff;
    text-align: center;
    white-space: nowrap;
    vertical-align: baseline;
    border-radius: 0.375rem;
    margin-right: 0.25rem;
}

.badge-primary { background-color: var(--primary-color); }
.badge-success { background-color: var(--success); }
.badge-secondary { background-color: var(--gray-500); }
</style>
{% endblock %}