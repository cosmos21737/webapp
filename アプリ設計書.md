# 野球部タレントマネジメントシステム 基本設計書

## 1. システム概要

### 1.1 システム名
野球部タレントマネジメントシステム（Baseball Team Talent Management System）

### 1.2 目的
神奈川県立JPT高校野球部において、部員の個性・スキルの把握とチーム実力の可視化を行い、適切な戦略策定と中長期的な育成計画の立案を支援する。

### 1.3 システムの特徴
- 測定記録の電子化と承認ワークフロー
- 時系列での記録推移の可視化
- チーム全体の傾向分析
- スマートフォン対応によるアクセシビリティ向上

## 2. 機能要件

### 2.1 課題1：必須機能

#### 2.1.1 マネージャー機能
- **測定記録入力機能**
  - 各部員の測定結果を一括入力
  - 測定項目：50m走、ベースランニング、遠投、ストレート球速、打球速度、スイング速度、ベンチプレス、スクワット
  - 入力データの検証（範囲チェック、必須項目チェック）
- **承認フロー発行機能**
  - 部員への承認依頼通知送信
  - 承認状況の確認

#### 2.1.2 部員機能
- **測定記録承認機能**
  - 自身の測定結果確認
  - 承認・差し戻し機能
- **記録閲覧機能**
  - 自身の過去記録の時系列表示

#### 2.1.3 コーチ機能
- **最終承認機能**
  - 部員承認済み記録の最終確認
  - 承認・差し戻し機能
- **全部員記録閲覧機能**
  - 全部員の記録一覧表示
  - 個別部員の詳細記録表示
- **部員管理機能**
  - 部員の新規作成
  - 部員の退部・引退処理

#### 2.1.4 監督機能
- **全部員記録閲覧機能**
  - 全部員の記録一覧表示
  - 個別部員の詳細記録表示
- **部員管理機能**
  - 部員の新規作成
  - 部員の退部・引退処理

## 3. システム構成

### 3.1 技術スタック
- **フロントエンド**: Javascript
- **バックエンド**: Flask
- **データベース**: SQlite

### 3.2 デプロイ環境
- **開発環境**: ローカル開発サーバー
- **本番環境**: クラウドサービス（Google Cloud Run）

## 4. データベース設計

### 4.1 エンティティ関係図（ER図）
ER.mdを参照。

### 4.2 テーブル定義

### 1. USERS テーブル（ユーザー管理）
| カラム名         | データ型        | 制約              | 説明                                |
|-----------------|---------------|------------------|------------------------------------|
| `user_id`           | `int`       | `PRIMARY KEY`    | ユーザーID                         |
| `name`         | `string`  | `NOT NULL`       | 氏名                              |
| `password_hash` | `string`  | `NOT NULL`       | パスワードハッシュ                  |
| `role`         | `enum`   | `NOT NULL`       | 役割 (`member`, `manager`, `coach`, `director`) |
| `grade`        | `int`       | -                | 学年（部員のみ）                    |
| `is_active`    | `boolean`       | `DEFAULT TRUE`   | 活動しているか                      |
| `created_at`   | `datetime`     | `DEFAULT NOW()`  | 作成日時                           |
| `updated_at`   | `datetime`     | `DEFAULT NOW()`  | 更新日時                           |

---

### 2. MEASUREMENT_RECORDS テーブル（測定記録管理）
| カラム名            | データ型        | 制約              | 説明                                |
|--------------------|---------------|------------------|------------------------------------|
| `record_id`       | `se`       | `PRIMARY KEY`    | 測定記録ID                         |
| `user_id`        | `int`      | `FOREIGN KEY`    | 部員のユーザーID                   |
| `measurement_date` | `date`        | `NOT NULL`       | 測定日                              |
| `run_50m`         | `decimal`      | -                | 50m走タイム（秒）                   |
| `base_running`    | `decimal`      | -                | ベースランニング（秒）              |
| `long_throw`      | `decimal`      | -                | 遠投距離（m）                      |
| `straight_speed`  | `decimal`      | -                | ストレート球速（km/h）              |
| `hit_speed`       | `decimal`      | -                | 打球速度（km/h）                    |
| `swing_speed`     | `decimal`      | -                | スイング速度（km/h）                |
| `bench_press`     | `decimal`      | -                | ベンチプレス（kg）                   |
| `squat`          | `decimal`      | -                | スクワット（kg）                    |
| `status`         | `enum`         | `NOT NULL`       | 承認ステータス (`draft`, `pending_member`, `pending_coach`, `approved`) |
| `created_by`     | `int`      | `FOREIGN KEY`    | 記録作成者のユーザーID              |
| `created_at`     | `datetime`    | `DEFAULT NOW()`  | 作成日時                           |
| `updated_at`     | `datetime`    | `DEFAULT NOW()`  | 更新日時                           |

---

### 3. APPROVAL_HISTORY テーブル（承認履歴）
| カラム名        | データ型       | 制約              | 説明                                |
|---------------|------------|------------------|------------------------------------|
| `approval_id` | `int`      | `PRIMARY KEY`    | 承認履歴ID                         |
| `record_id`   | `int`      | `FOREIGN KEY`    | 測定記録ID                         |
| `approver_id` | `int`      | `FOREIGN KEY`    | 承認者のユーザーID                 |
| `approver_type` | `enum`     | `NOT NULL`       | 承認者の種類 (`member`, `coach`)    |
| `action`      | `enum`     | `NOT NULL`       | 承認アクション (`approved`, `rejected`) |
| `comment`     | `text`     | -                | 承認コメント                        |
| `approved_at` | `datetime` | `DEFAULT NOW()`  | 承認日時                           |

---

### 4. NOTIFICATIONS テーブル（通知管理）
| カラム名         | データ型        | 制約              | 説明                                |
|-----------------|---------------|------------------|------------------------------------|
| `notification_id` | `string`    | `PRIMARY KEY`    | 通知ID                             |
| `user_id`      | `int`      | `FOREIGN KEY`    | 通知対象のユーザーID               |
| `record_id`    | `int`      | `FOREIGN KEY`    | 関連する測定記録ID                 |
| `type`         | `enum`         | `NOT NULL`       | 通知タイプ (`approval_request`, `approval_completed`, `record_updated`) |
| `title`        | `string`       | `NOT NULL`       | 通知タイトル                        |
| `message`      | `text`         | -                | 通知メッセージ                      |
| `is_read`      | `BOOLEAN`      | `DEFAULT FALSE`  | 既読フラグ                          |
| `created_at`   | `datetime`    | `DEFAULT NOW()`  | 作成日時                           |

---

### 5. MEMBER_STATUS テーブル（部員ステータス管理）
| カラム名        | データ型        | 制約              | 説明                                |
|---------------|---------------|------------------|------------------------------------|
| `status_id`   | `string`       | `PRIMARY KEY`    | ステータスID                        |
| `user_id`     | `int`      | `FOREIGN KEY`    | 対象のユーザーID                   |
| `status`      | `enum`         | `NOT NULL`       | ステータス (`active`, `withdrawn`, `retired`) |
| `status_date` | `DATE`         | `NOT NULL`       | ステータス変更日                    |
| `reason`      | `TEXT`         | -                | 変更理由                            |
| `updated_by`  | `int`      | `FOREIGN KEY`    | 更新者のユーザーID                  |
| `created_at`  | `datetime`    | `DEFAULT NOW()`  | 作成日時                           |



## 5. フロントエンド画面URL設計

### 5.1 共通画面
- `/` - トップページ（未ログイン時はログインへリダイレクト）
- `/login` - ログイン画面
- `/dashboard` - ダッシュボード（役割別メインメニュー）

### 5.2 マネージャー専用画面
- `/measurements/input` - 測定記録入力画面
- `/measurements/batch` - 一括入力画面（CSV取り込み）
- `/approvals/status` - 承認状況確認画面

### 5.3 部員専用画面
- `/my/records` - 個人記録画面（時系列表示）
- `/my/approvals` - 承認待ち一覧画面
- `/my/ranking` - 個人ランキング画面

### 5.4 コーチ・監督共通画面
- `/members` - 部員一覧画面
- `/members/:id` - 個人詳細画面
- `/members/:id/records` - 個人記録詳細画面
- `/analytics` - チーム分析画面
- `/analytics/trends` - 推移分析画面
- `/analytics/ranking` - チーム内ランキング画面
- `/approvals` - 承認待ち一覧画面（コーチ用）

### 5.5 コーチ・監督専用画面（管理機能）
- `/admin/members` - 部員管理画面
- `/admin/members/new` - 部員新規作成画面
- `/admin/members/:id/edit` - 部員情報編集画面

### 5.6 共通機能画面
- `/profile` - プロフィール設定画面
- `/settings` - システム設定画面
- `/help` - ヘルプ・マニュアル画面

## 6. 画面設計

### 6.1 共通画面
- **ログイン画面** - 認証機能
- **ダッシュボード** - 役割別メインメニュー
- **ヘッダーナビゲーション** - 画面遷移とログアウト

### 6.2 マネージャー画面
- **測定記録入力画面** - 一括入力フォーム
- **承認状況確認画面** - 承認フロー管理

### 6.3 部員画面
- **承認待ち一覧画面** - 承認対象記録表示
- **個人記録画面**

### 6.4 コーチ・監督画面
- **部員一覧画面** - 全部員の最新記録
- **個人詳細画面** - 特定部員の詳細情報
- **部員管理画面** - 部員の追加・編集・削除

### 8 互換性要件
- ブラウザ：Microsoft Edge, Chrome, Safari, Firefox
- OS：Windows 11 Education
- デバイス：PC、スマートフォン、タブレット
## 9 今後の拡張予定
- チーム統計機能
- グラフ表示機能